<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
            http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

 
 	<changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="mysql">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="SUBSTRING_INDEX(cm_group_name, '-UUID-', 1)"/>            
        </update>
    </changeSet>
    
    <changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="mssql">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="cm_group_name"/>            
        </update>
    </changeSet>
    <changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="mssql">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="SUBSTRING(cm_group_display_name,0,CHARINDEX('-UUID-',cm_group_display_name,0))"/>
            <where>cm_group_display_name LIKE '%-UUID-%'</where>            
        </update>
    </changeSet>
    
    <changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="oracle">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="cm_group_name"/>            
        </update>
    </changeSet>
    <changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="oracle">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="substr(cm_group_display_name, 1, instr(cm_group_display_name, '-UUID-') - 1)"/>
            <where>cm_group_display_name LIKE '%-UUID-%'</where>            
        </update>
    </changeSet>
    
    <changeSet id="01-acm-group-populate-cm-group-display-name-from-cm-group-name" author="marko.stojanoski" dbms="postgresql">
        <update tableName="acm_group">
            <column name="cm_group_display_name" value="split_part(cm_group_name, '-UUID-', 1)"/>            
        </update>
    </changeSet> 

</databaseChangeLog>

